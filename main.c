#include <stdio.h>
#include "geometry.h"

double x[] = { 18.923634, 20.785405, 23.265396, 23.519158, 25.773353, 21.905217, 22.392098, 18.744859, 15.268183, 12.275522, 6.020012, 7.620959, 9.391452, 12.062355, 12.311361, 13.034669, 9.568842, 7.021736, 4.175441, 2.597807, -2.983517, -4.806137, -7.557571, -5.366529, -2.876349, -1.765355, -0.472442, -0.691273, -4.060655, -9.668344, -9.546349, -11.393367, -15.589847, -15.781402, -17.167979, -12.297521, -11.691211, -14.877785, -12.386093, -17.388411, -16.194544, -17.769652, -24.620949, -22.681055, -25.048153, -25.606868, -23.972884, -23.128211, -23.672942, -25.384947, -22.736523, -23.997834, -27.658874, -27.382894, -31.569290, -30.004975, -29.570643, -28.455579, -27.587595, -28.604500, -29.758055, -28.221040, -30.075437, -29.001671, -30.069964, -31.749937, -33.149964, -32.408488, -32.884029, -34.665807, -31.020465, -30.000540, -32.086869, -33.211886, -30.136953, -30.032314, -28.813050, -30.275183, -30.075392, -29.423221, -30.015754, -29.508041, -28.229321, -30.879221, -30.146701, -24.617265, -22.147817, -23.267767, -20.135337, -23.659317, -25.195474, -24.919976, -25.102750, -24.204874, -23.743463, -20.100543, -20.126036, -16.347129, -12.444440, -13.746040, -14.358646, -16.201193, -17.944981, -17.145195, -14.679456, -16.197895, -10.250132, -10.082153, -2.328241, 0.221225, 1.451867, -3.011749, -7.014415, -6.397871, -6.676167, -6.886807, -3.792815, 0.487883, 5.976959, 7.008582, 10.415583, 10.867642, 9.064578, 5.523652, 5.226736, 6.085214, 6.646211, 8.794452, 14.450773, 19.806230, 19.428253, 23.432644, 23.373123, 24.996973, 18.744129, 21.708845, 21.228736, 19.871647, 22.091006, 27.256825, 30.110987, 34.068802, 37.921020, 37.016823, 37.431763, 34.780331, 31.514788, 31.637714, 33.941592, 37.879958, 40.604719, 42.330399, 45.350488, 44.181859, 48.339711, 43.716305, 43.002291, 46.051624, 43.971348, 42.995986, 46.177408, 45.876566, 50.203453, 51.170509, 55.383085, 53.852988, 51.709906, 50.623126, 51.752288, 54.573067, 50.340041, 50.884305, 52.465736, 55.885552, 54.524628, 55.620999, 53.879624, 54.123697, 56.080350, 57.854774, 55.984748, 57.190775, 58.794890, 56.151672, 54.172584, 56.649240, 53.316852, 57.052328, 54.837745, 55.871594, 58.873129, 57.935843, 56.057977, 54.045639, 53.759146, 51.357507, 51.655739, 49.841858, 51.004339, 53.522595, 52.987757, 53.949344, 52.370394, 51.485995, 52.774439, 47.304935, 49.421136, 43.308002, 41.612289, 41.540845, 42.181473, 44.072856, 47.075173, 44.277908, 44.400113, 43.585093, 40.280016, 36.376476, 33.217696, 29.599808, 32.429063, 32.384467, 35.208843, 37.576038, 36.088765, 35.542364, 34.350640, 28.131376, 27.633725, 25.040362, 21.396236};
double y[] = { 94.943907, 103.939205, 113.472091, 120.296137, 126.466356, 131.198607, 130.935902, 128.671726, 128.660432, 119.427015, 111.264617, 97.093845, 107.062982, 114.865642, 122.424812, 125.312327, 129.961297, 130.865478, 130.463511, 127.189965, 124.788511, 114.854437, 100.157389, 109.529989, 115.978734, 120.751790, 127.891287, 128.781418, 130.501977, 128.785292, 128.070106, 121.639069, 119.033808, 106.953030, 112.174814, 118.488727, 120.220586, 126.527896, 128.346272, 129.298108, 129.373779, 126.382031, 120.286203, 117.071233, 109.666611, 113.474544, 114.341684, 118.588796, 119.734399, 122.655856, 124.880913, 124.388924, 120.755907, 117.360781, 115.467038, 113.422740, 114.100537, 112.751260, 113.840504, 115.404945, 115.520083, 113.603658, 115.185168, 113.015111, 115.566382, 113.802033, 112.961253, 111.437379, 111.746621, 107.931065, 107.794867, 106.125316, 106.641087, 105.153581, 108.403386, 109.475677, 108.833157, 115.575901, 113.251647, 109.569747, 103.046399, 102.505903, 98.481287, 96.647616, 100.231958, 98.275546, 101.659577, 108.460455, 113.338075, 109.998967, 104.118014, 97.871711, 91.594711, 88.700931, 87.204127, 89.096710, 93.066201, 96.589081, 100.598978, 114.213866, 108.338334, 100.825727, 92.734192, 85.668319, 84.358065, 83.147064, 83.795357, 88.033830, 89.738460, 96.015890, 113.758891, 105.613069, 94.805518, 89.862558, 81.232103, 80.104177, 77.640613, 75.055984, 80.271826, 84.966970, 92.392760, 106.952780, 97.456788, 92.861445, 84.359546, 80.555596, 72.834561, 74.924712, 71.558467, 76.849033, 80.643449, 87.982111, 105.541771, 95.139296, 89.607137, 84.817824, 78.545420, 72.191668, 74.898731, 74.535454, 77.428240, 81.511926, 87.653771, 99.645885, 93.728541, 90.309698, 84.237902, 79.046967, 74.224098, 72.549953, 74.393805, 76.841731, 83.215438, 86.003582, 95.949900, 92.174245, 90.774222, 87.179826, 82.346814, 81.338903, 78.749698, 80.484043, 79.671770, 86.568263, 89.892790, 94.643955, 89.342166, 89.671396, 85.930200, 87.521942, 86.809032, 84.398224, 87.070467, 84.771752, 87.064093, 88.545353, 92.842387, 94.077527, 94.015582, 94.477244, 95.076399, 95.259510, 91.899649, 92.677641, 91.286413, 92.473652, 94.457903, 89.372395, 94.339384, 94.111488, 99.289034, 103.261049, 100.370819, 102.391222, 102.073997, 99.488635, 101.358225, 94.757485, 88.752667, 95.196497, 102.409046, 106.143368, 108.543500, 110.969105, 109.669397, 109.112341, 108.480291, 105.666228, 102.952019, 90.153602, 97.327601, 102.447265, 109.009954, 117.583864, 117.953551, 118.627073, 118.588529, 116.702091, 112.960794, 107.481610, 90.366952, 102.778971, 109.195014, 114.405072, 123.573394, 126.150529, 126.704086, 124.083813, 121.328968, 117.999521, 110.795023};
double z[] = { 27.951207, 32.958822, 31.772349, 27.201047, 28.049645, 21.085678, 17.097274, 8.919927, 4.575679, 0.290555, -4.763882, 35.409265, 36.183602, 38.137181, 33.481719, 30.284211, 29.730307, 21.756280, 16.063991, 12.801134, 7.508908, 5.905422, 41.100204, 42.223040, 39.414838, 36.604641, 34.974385, 33.688452, 25.407572, 24.475070, 16.399907, 14.093553, 13.683870, 38.670922, 41.926927, 40.931905, 38.847875, 37.885779, 37.633551, 33.962717, 28.615194, 27.791253, 21.621761, 22.336605, 41.403838, 41.071029, 39.105122, 37.164280, 37.778050, 34.582480, 34.989590, 31.231165, 29.223522, 31.096948, 30.182645, 36.348053, 35.613437, 34.306081, 37.283780, 33.491020, 36.571224, 35.444917, 36.149363, 34.842217, 36.026867, 34.037412, 29.000291, 30.032029, 30.327320, 32.911176, 33.405858, 32.275999, 34.508547, 35.872299, 33.754145, 37.063826, 37.668725, 20.781074, 20.759428, 21.863867, 23.205067, 25.744317, 26.251096, 32.398904, 31.309991, 37.458048, 40.396805, 39.881684, 13.373780, 12.220379, 12.911858, 15.270712, 16.894765, 20.949380, 26.955163, 28.361166, 31.269878, 38.150276, 38.374526, 4.551062, 6.723703, 4.207912, 5.795145, 12.604157, 16.728257, 18.429380, 22.069833, 27.663695, 35.406414, 37.601410, -2.640391, -1.804721, -2.151656, -2.486868, 3.878205, 6.384561, 11.069157, 17.211253, 25.611345, 29.713559, 31.393665, -8.723052, -8.969038, -10.972261, -9.405601, -2.110072, 0.912586, 6.576262, 12.117366, 14.291045, 21.342586, 25.918549, -12.564448, -14.508332, -13.371405, -10.569334, -8.115435, -3.103172, -1.146003, 2.944037, 11.333020, 14.167181, 16.568683, -13.267877, -18.304380, -17.329888, -13.934110, -12.248553, -11.036024, -6.620359, 0.525597, 3.189993, 5.684937, 9.906041, -16.870602, -13.913950, -17.607610, -15.643366, -11.215820, -9.478677, -10.829289, -3.695346, -2.575663, -2.102781, -1.140791, -15.451427, -14.555542, -10.918271, -15.283468, -11.725691, -9.020648, -8.527806, -7.010034, -10.057165, -7.686957, -6.509314, -7.157553, -8.400447, -6.840326, -6.690948, -6.569118, -9.223643, -12.103165, -9.325506, -12.196589, -10.185554, -10.652871, -0.086182, -2.449069, 0.231928, -4.136415, -4.516971, -5.294957, -8.794513, -8.875631, -10.583389, -12.937109, -15.926917, 4.937407, 8.512767, 6.679871, 5.338037, 2.455340, -1.849938, -4.486821, -7.841663, -8.962107, -12.795511, -16.005266, 15.018648, 17.984313, 15.999835, 16.042423, 11.503658, 5.294068, 4.730697, -1.173028, -5.916648, -7.761526, -14.741867, 24.114380, 23.228455, 21.589342, 23.877027, 18.452667, 15.627276, 11.181242, 4.773883, 0.468603, -5.038128, -10.785710};

int main() {
    Vector vx = vec_from_array(x, 231);
    Vector vy = vec_from_array(y, 231);
    Vector vz = vec_from_array(z, 231);
    Callibration_t calib = calib_calibrate_sensor(vx, vy, vz);
    vec_print(calib.offset);
	mat_print(calib.rotation);	
    
	// new data = calib.rotation*(old data + calib.offset)
    return 0;
}